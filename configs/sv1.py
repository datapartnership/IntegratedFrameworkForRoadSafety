# The new config inherits a base config to highlight the necessary modification
_base_ = '../mmdetection/configs/mask_rcnn/mask_rcnn_r50_caffe_fpn_mstrain-poly_1x_coco.py'

# We also need to change the num_classes in head to match the dataset's annotation
model = dict(
    roi_head=dict(
        bbox_head=dict(num_classes=124),
        mask_head=dict(num_classes=124)))

# Modify dataset related settings
dataset_type = 'COCODataset'
classes = ('animal--bird',
 'animal--ground-animal',
 'construction--barrier--ambiguous',
 'construction--barrier--concrete-block',
 'construction--barrier--curb',
 'construction--barrier--fence',
 'construction--barrier--guard-rail',
 'construction--barrier--other-barrier',
 'construction--barrier--road-median',
 'construction--barrier--road-side',
 'construction--barrier--separator',
 'construction--barrier--temporary',
 'construction--barrier--wall',
 'construction--flat--bike-lane',
 'construction--flat--crosswalk-plain',
 'construction--flat--curb-cut',
 'construction--flat--driveway',
 'construction--flat--parking',
 'construction--flat--parking-aisle',
 'construction--flat--pedestrian-area',
 'construction--flat--rail-track',
 'construction--flat--road',
 'construction--flat--road-shoulder',
 'construction--flat--service-lane',
 'construction--flat--sidewalk',
 'construction--flat--traffic-island',
 'construction--structure--bridge',
 'construction--structure--building',
 'construction--structure--garage',
 'construction--structure--tunnel',
 'human--person--individual',
 'human--person--person-group',
 'human--rider--bicyclist',
 'human--rider--motorcyclist',
 'human--rider--other-rider',
 'marking--continuous--dashed',
 'marking--continuous--solid',
 'marking--continuous--zigzag',
 'marking--discrete--ambiguous',
 'marking--discrete--arrow--left',
 'marking--discrete--arrow--other',
 'marking--discrete--arrow--right',
 'marking--discrete--arrow--split-left-or-straight',
 'marking--discrete--arrow--split-right-or-straight',
 'marking--discrete--arrow--straight',
 'marking--discrete--crosswalk-zebra',
 'marking--discrete--give-way-row',
 'marking--discrete--give-way-single',
 'marking--discrete--hatched--chevron',
 'marking--discrete--hatched--diagonal',
 'marking--discrete--other-marking',
 'marking--discrete--stop-line',
 'marking--discrete--symbol--bicycle',
 'marking--discrete--symbol--other',
 'marking--discrete--text',
 'marking-only--continuous--dashed',
 'marking-only--discrete--crosswalk-zebra',
 'marking-only--discrete--other-marking',
 'marking-only--discrete--text',
 'nature--mountain',
 'nature--sand',
 'nature--sky',
 'nature--snow',
 'nature--terrain',
 'nature--vegetation',
 'nature--water',
 'object--banner',
 'object--bench',
 'object--bike-rack',
 'object--catch-basin',
 'object--cctv-camera',
 'object--fire-hydrant',
 'object--junction-box',
 'object--mailbox',
 'object--manhole',
 'object--parking-meter',
 'object--phone-booth',
 'object--pothole',
 'object--sign--advertisement',
 'object--sign--ambiguous',
 'object--sign--back',
 'object--sign--information',
 'object--sign--other',
 'object--sign--store',
 'object--street-light',
 'object--support--pole',
 'object--support--pole-group',
 'object--support--traffic-sign-frame',
 'object--support--utility-pole',
 'object--traffic-cone',
 'object--traffic-light--general-single',
 'object--traffic-light--pedestrians',
 'object--traffic-light--general-upright',
 'object--traffic-light--general-horizontal',
 'object--traffic-light--cyclists',
 'object--traffic-light--other',
 'object--traffic-sign--ambiguous',
 'object--traffic-sign--back',
 'object--traffic-sign--direction-back',
 'object--traffic-sign--direction-front',
 'object--traffic-sign--front',
 'object--traffic-sign--information-parking',
 'object--traffic-sign--temporary-back',
 'object--traffic-sign--temporary-front',
 'object--trash-can',
 'object--vehicle--bicycle',
 'object--vehicle--boat',
 'object--vehicle--bus',
 'object--vehicle--car',
 'object--vehicle--caravan',
 'object--vehicle--motorcycle',
 'object--vehicle--on-rails',
 'object--vehicle--other-vehicle',
 'object--vehicle--trailer',
 'object--vehicle--truck',
 'object--vehicle--vehicle-group',
 'object--vehicle--wheeled-slow',
 'object--water-valve',
 'void--car-mount',
 'void--dynamic',
 'void--ego-vehicle',
 'void--ground',
 'void--static',
 'void--unlabeled',)

data = dict(
    train=dict(
        img_prefix='data/training/images/',
        classes=classes,
        ann_file='data/training.json'),
    val=dict(
        img_prefix='data/validation/images/',
        classes=classes,
        ann_file='data/validation.json'),
    test=dict(
        img_prefix='data/validation/images/',
        classes=classes,
        ann_file='data/validation.json'))

# We can use the pre-trained Mask RCNN model to obtain higher performance
load_from = '../mmdetection/checkpoints/mask_rcnn_r50_caffe_fpn_mstrain-poly_3x_coco_bbox_mAP-0.408__segm_mAP-0.37_20200504_163245-42aa3d00.pth'
